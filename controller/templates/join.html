<!DOCTYPE html>
<html lang = "kr">
    <head>
        <meta charset = "UTF-8">
        <meta name = "viewport" content = "width=device-width, initial-scale=1.0">
        <meta http-equiv = "X-UA-Compatible" content = "ie=edge">
        <meta http-equiv="Content-Security-Policy" content="frame-src 'self' *.ea79-1-233-206-68.jp.ngrok.io;">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;500;700&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/06fb83cb17.js" crossorigin="anonymous"></script>
        <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
        <link rel = "stylesheet" href = "./public/style/style.css">
        <title>SmeetUP</title>
    </head>
    <body>
        <div class = "wrapper">
            <form id = "login-main" action = "https://a3d2-1-233-206-68.jp.ngrok.io/api/sign-up" method = "POST">
                <h1 id = "title">SmeetUP</h1>
                <!--<select name = "지역" id = "region" name = "regionName">
                    <option value = "Seoul">서울</option>
                    <option value = "Incheon">인천</option>
                    <option value = "Daejeon">대전</option>
                    <option value = "Daegu">대구</option>
                    <option value = "Ulsan">울산</option>
                    <option value = "Busan">부산</option>
                    <option value = "Gwangju">광주</option>
                    <option value = "Gyeonggi">경기</option>
                    <option value = "Gangwon">강원</option>
                    <option value = "Chungbuk">충북</option>
                    <option value = "Chungnam">충남</option>
                    <option value = "Gyeongbuk">경북</option>
                    <option value = "Gyeongnam">경남</option>
                    <option value = "Jeonbuk">전북</option>
                    <option value = "Jeonnam">전남</option>
                    <option value = "Jeju">제주</option>
                </select>-->
                <input type="text" id="inputregion" name = "regionName">
                <input id = "inputage" type = "text" placeholder = "Age" name = "age">
                <input id = "inputid" type = "text" placeholder = "Username" name = "username">
                <input id = "inputpw" type = "password" placeholder = "Password" name = "password">
                <input id = "pwc" type = "password" placeholder = "Password">
                <button type = "submit" onclick = "join()" id = "login">Start</button>
            </form>
        </div>
        <script>
            function join(){
                var regionname = $("#inputregion").val();
                var age = $("#inputage").val();
                var id = $("#inputid").val();
                var pw = $("#inputpw").val();
                var pwc = $("#pwc").val();

                var sendData = {regionName: regionname, age: age, username: id, password: pw};

                if(pw !== pwc){
                    alert("비밀번호 틀렸으니깐 다시 치세요.");
                }
                else{
                    var ajaxData = { 
                        type: "POST", 
                        url : "/api/sign-up",
                        data: sendData, 
                        success: onSuccess,
                        error: onSuccess
                    }

                    };
                    $.ajax(ajaxData);
                }
            }

            function onSuccess (data, status, xhr) { 
                console.log(data.condition);
                if(data.condition === "join"){
                    alert(data.message);        
                    window.location.href = "./login.html";
                }
                else{
                    alert(data.message);        
                }
            }

            //function onError (jqXHR, textStatus, errorThrown) { 
            //    alert(`오류가 발생하였습니다: ${jqXHR.responseText}`); 
            //}
        </script>
    </body>
</html>